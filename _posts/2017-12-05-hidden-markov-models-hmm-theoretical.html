---
layout: post
title: 'Hidden Markov Models (HMM): Theoretical Background'
date: '2017-12-05T21:37:00.000-08:00'
author: Sujay S Kumar
tags: 
modified_time: '2017-12-05T21:37:41.820-08:00'
thumbnail: https://4.bp.blogspot.com/-X0NomdJBYBw/WiazLkBPx5I/AAAAAAAAKkc/_0NvEd5zbusO6j0JdQsYxHCdDrakQYlZACLcBGAs/s72-c/TrellisDiagram.png
blogger_id: tag:blogger.com,1999:blog-925060870564624560.post-1886062490513676810
blogger_orig_url: http://sujayskumar.blogspot.com/2017/12/hidden-markov-models-hmm-theoretical.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div>Hidden Markov Models (HMM) were the mainstay of generative models a couple of years ago. Even though more sophisticated Deep Learning generative models have emerged, we cannot rule out the effectiveness of the humble HMM. After all, one of the most widely known principle (Occam's Razor) states that if you have a number of competing hypothesis, the simplest one is the best one. The purpose of this blog post is to explore the mathematical basis on which HMMs are built. </div></div><div dir="ltr" style="text-align: left;" trbidi="on"><div><br />Hidden Markov Models are characterized by two types of states, Hidden States and Observable States. Any HMM can be represented by three parameters:<br /><ol style="text-align: left;"><li>Transition Probability: The probability of the model to transition from one hidden state to the other given the current state.</li><li>Emission Probability: The probability of the model to emit an observable state given the current hidden state.</li><li>Initial Probability: The probability of the model being in a specific hidden state when it starts off.</li></ol>Graphically, HMM are represented using a Trellis Diagram:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-X0NomdJBYBw/WiazLkBPx5I/AAAAAAAAKkc/_0NvEd5zbusO6j0JdQsYxHCdDrakQYlZACLcBGAs/s1600/TrellisDiagram.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="221" data-original-width="461" height="153" src="https://4.bp.blogspot.com/-X0NomdJBYBw/WiazLkBPx5I/AAAAAAAAKkc/_0NvEd5zbusO6j0JdQsYxHCdDrakQYlZACLcBGAs/s320/TrellisDiagram.png" width="320" /></a></div><br /><br />There are four algorithms fundamental to HMM: Forward algorithm, Backward algorithm, Forward-Backward algorithm and Viterbi Algorithm.<br /><br /><b>Forward Algorithm:</b></div><div></div><div>Goal - To calculate <br /><a href="https://www.codecogs.com/eqnedit.php?latex=P(Z_{k},X_{1:k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P(Z_{k},X_{1:k})" title="P(Z_{k},X_{1:k})" /></a><br /><br />Using marginalization, <br /><a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{Z_{k-1}}^{n}P(Z_{k},Z_{k-1},X_{1:k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{Z_{k-1}}^{n}P(Z_{k},Z_{k-1},X_{1:k})" title="\sum_{Z_{k-1}}^{n}P(Z_{k},Z_{k-1},X_{1:k})" /></a><br /><a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{Z_{k-1}}^{n}P(X_{k},X_{1:k-1},Z_{k},Z_{k-1})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{Z_{k-1}}^{n}P(X_{k},X_{1:k-1},Z_{k},Z_{k-1})" title="\sum_{Z_{k-1}}^{n}P(X_{k},X_{1:k-1},Z_{k},Z_{k-1})" /></a><br /><a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{Z_{k-1}}^{n}P(X_{k}|X_{1:k-1},Z_{k},Z_{k-1})P(Z_{k}|Z_{k-1},X_{1:k-1})P(Z_{k-1},X_{1:k-1})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{Z_{k-1}}^{n}P(X_{k}|X_{1:k-1},Z_{k},Z_{k-1})P(Z_{k}|Z_{k-1},X_{1:k-1})P(Z_{k-1},X_{1:k-1})" title="\sum_{Z_{k-1}}^{n}P(X_{k}|X_{1:k-1},Z_{k},Z_{k-1})P(Z_{k}|Z_{k-1},X_{1:k-1})P(Z_{k-1},X_{1:k-1})" /></a><br /><br />Since <a href="https://www.codecogs.com/eqnedit.php?latex=X_{k}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?X_{k}" title="X_{k}" /></a>, <a href="https://www.codecogs.com/eqnedit.php?latex=X_{1:k-1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?X_{1:k-1}" title="X_{1:k-1}" /></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=Z_{k-1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Z_{k-1}" title="Z_{k-1}" /></a> are independent, <br /><br /><a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{Z_{k-1}}^{n}P(X_{k}|Z_{k})P(Z_{k}|Z_{k-1})P(Z_{k-1},X_{1:k-1})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{Z_{k-1}}^{n}P(X_{k}|Z_{k})P(Z_{k}|Z_{k-1})P(Z_{k-1},X_{1:k-1})" title="\sum_{Z_{k-1}}^{n}P(X_{k}|Z_{k})P(Z_{k}|Z_{k-1})P(Z_{k-1},X_{1:k-1})" /></a><br /><a href="https://www.codecogs.com/eqnedit.php?latex=\alpha_{k}&amp;space;=&amp;space;\sum_{Z_{k-1}=1}^{n}(Emission&amp;space;Probability)(Transition&amp;space;Probability)\alpha_{k-1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\alpha_{k}&amp;space;=&amp;space;\sum_{Z_{k-1}=1}^{n}(Emission&amp;space;Probability)(Transition&amp;space;Probability)\alpha_{k-1}" title="\alpha_{k} = \sum_{Z_{k-1}=1}^{n}(Emission Probability)(Transition Probability)\alpha_{k-1}" /></a><br /><br /><b>Backward Algorithm:</b><br /><br />Goal - To calculate<br /><a href="https://www.codecogs.com/eqnedit.php?latex=P(X_{k+1:n}|Z_{k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P(X_{k+1:n}|Z_{k})" title="P(X_{k+1:n}|Z_{k})" /></a><br /><br />Using marginalization, <br /><a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{Z_{k+1}=1}^{n}P(X_{k+1},&amp;space;X_{k+2:n},&amp;space;Z_{k+1}|&amp;space;Z_{k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{Z_{k+1}=1}^{n}P(X_{k+1},&amp;space;X_{k+2:n},&amp;space;Z_{k+1}|&amp;space;Z_{k})" title="\sum_{Z_{k+1}=1}^{n}P(X_{k+1}, X_{k+2:n}, Z_{k+1}| Z_{k})" /></a><br /><a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{Z_{k+1}=1}^{n}P(X_{k+1}|&amp;space;X_{k+2:n},&amp;space;Z_{k+1},&amp;space;Z_{k})P(X_{k+2:n}|&amp;space;Z_{k+1},&amp;space;Z_{k})P(Z_{k+1}|&amp;space;Z_{k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{Z_{k+1}=1}^{n}P(X_{k+1}|&amp;space;X_{k+2:n},&amp;space;Z_{k+1},&amp;space;Z_{k})P(X_{k+2:n}|&amp;space;Z_{k+1},&amp;space;Z_{k})P(Z_{k+1}|&amp;space;Z_{k})" title="\sum_{Z_{k+1}=1}^{n}P(X_{k+1}| X_{k+2:n}, Z_{k+1}, Z_{k})P(X_{k+2:n}| Z_{k+1}, Z_{k})P(Z_{k+1}| Z_{k})" /></a><br /><a href="https://www.codecogs.com/eqnedit.php?latex=\sum_{Z_{k+1}=1}^{n}P(X_{k+1}|&amp;space;Z_{k+1})P(X_{k+2:n}|&amp;space;Z_{k+1})P(Z_{k+1}|&amp;space;Z_{k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\sum_{Z_{k+1}=1}^{n}P(X_{k+1}|&amp;space;Z_{k+1})P(X_{k+2:n}|&amp;space;Z_{k+1})P(Z_{k+1}|&amp;space;Z_{k})" title="\sum_{Z_{k+1}=1}^{n}P(X_{k+1}| Z_{k+1})P(X_{k+2:n}| Z_{k+1})P(Z_{k+1}| Z_{k})" /></a><br /><a href="https://www.codecogs.com/eqnedit.php?latex=\beta&amp;space;_{k}&amp;space;=&amp;space;\sum_{Z_{k+1}=1}^{n}(Emission&amp;space;Probability)\beta_{k+1}(Transition&amp;space;Probability)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\beta&amp;space;_{k}&amp;space;=&amp;space;\sum_{Z_{k+1}=1}^{n}(Emission&amp;space;Probability)\beta_{k+1}(Transition&amp;space;Probability)" title="\beta _{k} = \sum_{Z_{k+1}=1}^{n}(Emission Probability)\beta_{k+1}(Transition Probability)" /></a><br /><br /><b>Forward-Backward (Baum Welch) Algorithm:</b><br /><br />Goal - To compute<br /><a href="https://www.codecogs.com/eqnedit.php?latex=P(Z_{k}|X)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P(Z_{k}|X)" title="P(Z_{k}|X)" /></a><br /><br />where<br /><a href="https://www.codecogs.com/eqnedit.php?latex=X&amp;space;=&amp;space;(X_{1},&amp;space;X_{2},..&amp;space;X_{n})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?X&amp;space;=&amp;space;(X_{1},&amp;space;X_{2},..&amp;space;X_{n})" title="X = (X_{1}, X_{2},.. X_{n})" /></a><br /><br /><a href="https://www.codecogs.com/eqnedit.php?latex=P(Z_{k}|X)\propto&amp;space;P(Z_{k},X)&amp;space;=&amp;space;P(X_{k+1:n}|Z_{k},X_{1:k})P(Z_{k},X_{1:k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P(Z_{k}|X)\propto&amp;space;P(Z_{k},X)&amp;space;=&amp;space;P(X_{k+1:n}|Z_{k},X_{1:k})P(Z_{k},X_{1:k})" title="P(Z_{k}|X)\propto P(Z_{k},X) = P(X_{k+1:n}|Z_{k},X_{1:k})P(Z_{k},X_{1:k})" /></a><br /><br />Here, <a href="https://www.codecogs.com/eqnedit.php?latex=X_{k+1:n}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?X_{k+1:n}" title="X_{k+1:n}" /></a> is independent of <a href="https://www.codecogs.com/eqnedit.php?latex=X_{1:k}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?X_{1:k}" title="X_{1:k}" /></a> given <a href="https://www.codecogs.com/eqnedit.php?latex=Z_{k}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Z_{k}" title="Z_{k}" /></a><br /><br /><a href="https://www.codecogs.com/eqnedit.php?latex=P(Z_{k},X)&amp;space;=&amp;space;P(X_{k+1:n}|Z_{k})P(Z_{k},X_{1:k})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P(Z_{k},X)&amp;space;=&amp;space;P(X_{k+1:n}|Z_{k})P(Z_{k},X_{1:k})" title="P(Z_{k},X) = P(X_{k+1:n}|Z_{k})P(Z_{k},X_{1:k})" /></a><br /><br /><a href="https://www.codecogs.com/eqnedit.php?latex=P(Z_{k},X)&amp;space;=&amp;space;(Backward&amp;space;Algorithm)(Forward&amp;space;Algorithm)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?P(Z_{k},X)&amp;space;=&amp;space;(Backward&amp;space;Algorithm)(Forward&amp;space;Algorithm)" title="P(Z_{k},X) = (Backward Algorithm)(Forward Algorithm)" /></a><br /><br /></div></div></div>